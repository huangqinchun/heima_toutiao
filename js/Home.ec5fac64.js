"use strict";(self["webpackChunktoutiao"]=self["webpackChunktoutiao"]||[]).push([[268],{8949:function(t,n,e){e.r(n),e.d(n,{default:function(){return w}});var s=function(){var t=this,n=t.$createElement,s=t._self._c||n;return s("div",[s("div",[s("van-nav-bar",{attrs:{fixed:""},scopedSlots:t._u([{key:"left",fn:function(){return[s("img",{staticClass:"logo",attrs:{src:e(6949),alt:""}})]},proxy:!0},{key:"right",fn:function(){return[s("van-icon",{attrs:{name:"search",size:"0.54rem",color:"#fff"},on:{click:t.moveSearchFn}})]},proxy:!0}])})],1),s("div",{staticClass:"main"},[s("van-tabs",{attrs:{animated:"",sticky:"","offset-top":"0.46rem"},model:{value:t.channelId,callback:function(n){t.channelId=n},expression:"channelId"}},t._l(t.channelsList,(function(n){return s("van-tab",{key:n.id,attrs:{title:n.name,name:n.id}},[s("ArticleList",{attrs:{channelId:t.channelId}})],1)})),1),s("van-icon",{staticClass:"moreChannels",attrs:{name:"plus",size:"0.37333334rem"},on:{click:function(n){t.show=!0}}})],1),s("van-popup",{attrs:{"get-container":"body"},model:{value:t.show,callback:function(n){t.show=n},expression:"show"}},[s("ChannelEdit",{attrs:{userList:t.channelsList,unCheckLIst:t.unCheckChannelList},on:{addChannelEv:t.addChannelFn,removeChannelEV:t.removeChannelFn,closeEv:t.closeFn},model:{value:t.channelId,callback:function(n){t.channelId=n},expression:"channelId"}})],1)],1)},a=[],i=e(693),l=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("van-pull-refresh",{on:{refresh:t.onRefresh},model:{value:t.isLoading,callback:function(n){t.isLoading=n},expression:"isLoading"}},[e("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了","immediate-check":!1,offset:"50"},on:{load:t.onLoad},model:{value:t.loading,callback:function(n){t.loading=n},expression:"loading"}},t._l(t.list,(function(n){return e("ArticleItem",{key:n.art_id,attrs:{artObj:n},on:{dislikeEV:t.dislikeFn,reportEV:t.reportFn},nativeOn:{click:function(e){return t.itemClickFn(n.art_id)}}})})),1)],1)],1)},c=[],r=(e(5642),e(8398)),o=e(7118),h={name:"ArticleList",props:{channelId:Number},data(){return{list:[],loading:!1,finished:!1,thetime:(new Date).getTime(),isLoading:!1}},methods:{async getArticleList(){const t=await(0,i.xP)({channel_id:this.channelId,timestamp:this.thetime});this.thetime=t.data.data.pre_timestamp,this.list=[...this.list,...t.data.data.results],this.loading=!1,null===t.data.data.pre_timestamp&&(this.finished=!0)},onLoad(){0!==this.list.length?this.list.length>0&&this.getArticleList():this.loading=!1},async onRefresh(){this.thetime=(new Date).getTime();const{data:t}=await(0,i.xP)({channel_id:this.channelId,timestamp:this.thetime});this.thetime=t.data.pre_timestamp,this.list=t.data.results,this.isLoading=!1},async dislikeFn(t){try{const{data:n}=await(0,i.s9)({artId:t});console.log(n),(0,r.Z)({type:"success",message:"反馈成功"})}catch(n){}},async reportFn(t,n){try{const{data:e}=await(0,i.gk)({artId:t,value:n});console.log(e),(0,r.Z)({type:"success",message:"举报成功"})}catch(e){}},itemClickFn(t){this.$router.push({path:`/detail?art_id=${t}`})}},components:{ArticleItem:o.Z},created(){this.getArticleList()}},d=h,u=e(1001),m=(0,u.Z)(d,l,c,!1,null,null,null),f=m.exports,p=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",[e("van-nav-bar",{attrs:{title:"频道管理"},scopedSlots:t._u([{key:"right",fn:function(){return[e("van-icon",{attrs:{name:"cross",size:"0.37333334rem",color:"white"},on:{click:t.closeFn}})]},proxy:!0}])}),e("div",{staticClass:"my-channel-box"},[e("div",{staticClass:"channel-title"},[e("span",[t._v("我的频道 "),e("span",{staticClass:"small-title"},[t._v(" "+t._s(t.isEdit?"点击删除频道":"点击进入频道")+" ")])]),e("span",{on:{click:function(n){t.isEdit=!t.isEdit}}},[t._v(t._s(t.isEdit?"完成":"编辑"))])]),e("van-row",{attrs:{type:"flex"}},t._l(t.userList,(function(n){return e("van-col",{key:n.id,attrs:{span:"6"},on:{click:function(e){return t.removeChannel(n)}}},[e("div",{staticClass:"channel-item van-hairline--surround"},[t._v(" "+t._s(n.name)+" "),t.isEdit&&"推荐"!==n.name?e("van-badge",{staticClass:"cross-badge",attrs:{color:"transparent"},scopedSlots:t._u([{key:"content",fn:function(){return[e("van-icon",{staticClass:"badge-icon",attrs:{name:"cross",color:"#cfcfcf",size:"0.32rem"}})]},proxy:!0}],null,!0)}):t._e()],1)])})),1)],1),e("div",{staticClass:"more-channel-box"},[t._m(0),e("van-row",{attrs:{type:"flex"}},t._l(t.unCheckLIst,(function(n){return e("van-col",{key:n.id,attrs:{span:"6"},on:{click:function(e){return t.moreFn(n)}}},[e("div",{staticClass:"channel-item van-hairline--surround"},[t._v(t._s(n.name))])])})),1)],1)],1)},v=[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"channel-title"},[e("span",[t._v("点击添加更多频道：")])])}],C={name:"ChannelEdit",props:{userList:{type:Array},unCheckLIst:{type:Array}},data(){return{isEdit:!1}},methods:{moreFn(t){this.isEdit&&this.$emit("addChannelEv",t)},removeChannel(t){this.isEdit?this.$emit("removeChannelEV",t):(this.$emit("input",t.id),this.closeFn())},closeFn(){this.isEdit=!1,this.$emit("closeEv")}}},k=C,_=(0,u.Z)(k,p,v,!1,null,"31a6cef4",null),g=_.exports,L={name:"Home",components:{ArticleList:f,ChannelEdit:g},data(){return{channelId:0,channelsList:[],allChannelList:[],show:!1}},methods:{async addChannelFn(t){this.channelsList.push(t),await(0,i.wJ)({channels:this.channelsList})},async removeChannelFn(t){this.channelsList=this.channelsList.filter((n=>"推荐"===t.name||t.id!==n.id)),await(0,i.wJ)({channels:this.channelsList})},closeFn(){this.show=!1},moveSearchFn(){this.$router.push("/search")}},computed:{unCheckChannelList(){const t=this.allChannelList.filter((t=>{const n=this.channelsList.findIndex((n=>n.id===t.id));return!(n>-1)}));return t}},async created(){const{data:t}=await(0,i.lS)();this.channelsList=t.data.channels;const{data:n}=await(0,i.Of)();this.allChannelList=n.data.channels}},y=L,E=(0,u.Z)(y,s,a,!1,null,"a4777d12",null),w=E.exports},6949:function(t,n,e){t.exports=e.p+"img/logo.d0d391a4.png"}}]);
//# sourceMappingURL=Home.ec5fac64.js.map